<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title th:text="'Laudo - ' + ${laudo.paciente}">Laudo Médico</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link href="/css/style.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="laudo-page">

    <div class="laudo-actions">
        <a th:href="@{/}" class="btn btn-outline-secondary">
            <i class="fa-solid fa-arrow-left me-2"></i>Voltar ao Dashboard
        </a>
        <button onclick="window.print()" class="btn btn-primary">
            <i class="fa-solid fa-print me-2"></i>Imprimir / Salvar PDF
        </button>
    </div>

    <div class="notificacoes-enviadas mt-4 mb-4">
        <div class="alert alert-success">
            <h5><i class="fa-solid fa-check-circle me-2"></i>Notificações Enviadas com Sucesso!</h5>
            <p><strong>Email:</strong> <span th:text="${emailPaciente}"></span></p>
            <p><strong>WhatsApp:</strong> <span th:text="${telefonePaciente}"></span></p>
            <p class="mb-0">O paciente foi notificado sobre a disponibilidade do exame.</p>
        </div>
    </div>


    <div class="laudo-container">

        <header class="laudo-header">
            <h1>ROBATO Diagnósticos</h1>
            <h2 th:text="'Laudo de ' + ${tipoExame}">Laudo de Exame</h2>
        </header>

        <section class="laudo-info">
            <div class="info-item">
                <strong>Paciente:</strong>
                <span th:text="${laudo.paciente}">Nome Completo do Paciente</span>
            </div>
            <div class="info-item">
                <strong>Convênio:</strong>
                <span th:text="${laudo.convenio}">Particular</span>
            </div>
            <div class="info-item">
                <strong>Médico Solicitante:</strong>
                <span th:text="${laudo.medicoSolicitante}">Dr(a). Nome do Solicitante</span>
            </div>
            <div class="info-item">
                <strong>Data do Laudo:</strong>
                <span th:text="${#temporals.format(laudo.data, 'dd/MM/yyyy')}">21/08/2025</span>
            </div>
        </section>

        <main class="laudo-body">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Exame</th>
                        <th>Resultado</th>
                        <th>Unidade</th>
                        <th>Valor de Referência</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:if="${#lists.isEmpty(laudo.resultados)}">
                        <td colspan="4" class="text-center text-muted">Nenhum resultado encontrado para este laudo.</td>
                    </tr>
                    <tr th:each="item : ${laudo.resultados}">
                        <td th:text="${item.nomeExame}">Exame</td>
                        <td th:text="${item.valor}">Resultado</td>
                        <td th:text="${item.unidade}">Unidade</td>
                        <td th:text="${item.valorReferencia}">Valor de Referência</td>
                    </tr>
                </tbody>
            </table>

            <div th:if="${laudo.imagemBase64 != null}" class="mt-4">
                <h5>Imagem do Exame:</h5>
                <div class="text-center">
                    <img th:src="'data:image/jpeg;base64,' + ${laudo.imagemBase64}" class="img-fluid rounded shadow"
                        style="max-height: 400px;" alt="Imagem do exame" />
                    <p class="text-muted mt-2">Imagem referente ao exame realizado</p>
                </div>
            </div>

            <div th:if="${laudo.observacoes}" class="mt-4">
                <h5>Observações:</h5>
                <p th:text="${laudo.observacoes}"></p>
            </div>
        </main>

        <footer class="laudo-assinatura">
            <div class="assinatura-linha"></div>
            <p>
                <strong><span th:text="${laudo.medicoResponsavel}">Dr(a). Nome do Médico Responsável</span></strong><br>
                <span>CRM: </span><span th:text="${laudo.crmResponsavel}">00000-XX</span>
            </p>
        </footer>

    </div>
    <footer class="laudo-assinatura">
        <div class="assinatura-linha"></div>
        <p>
            <strong>
                <span th:text="${laudo.medicoResponsavel}">Dr(a). Nome do Médico Responsável</span>
            </strong><br>
            <span>CRM: </span><span th:text="${laudo.crmResponsavel}">00000-XX</span>
        </p>
    </footer>


</body>

</html>